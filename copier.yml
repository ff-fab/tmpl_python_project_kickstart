_min_copier_version: '9.11.3'
_subdirectory: 'template'
_jinja_extensions:
  - jinja2_time.TimeExtension
min_python_version:
  type: str
  default: '3.14'
  when: false
_message_before_copy: |
  Use a modern Python runtime when invoking Copier (for example: `uvx --python 3.14 --with jinja2-time copier copy . <target>`).
  Older Python runtimes can force older Copier/questionary combinations that crash in interactive prompts.

project_name:
  type: str
  help: The name of the project.
repo_name:
  type: str
  help: The name of the GitHub repository (without owner/organization).
  default: "{{ project_name|lower|replace(' ', '-') }}"
github_org:
  type: str
  help: The GitHub organization or username that owns the repository.
author_name:
  type: str
  help: The full name of the project author.
author_email:
  type: str
  help: The email address of the project author.
gh_token:
  type: str
  help: Optional GitHub token for local development integrations.
  default: ''
  secret: true
context7_api_key:
  type: str
  help: Optional Context7 API key for local development integrations.
  default: ''
  secret: true
module_name:
  type: str
  help: The name of the (first) Python module (package).
  default: "{{ project_name|lower|replace(' ', '_') }}"
description:
  type: str
  help: A short description of the project.
license:
  type: str
  choices: ['MIT', 'None']
  help: The software license to use.
  default: 'MIT'
codecov:
  type: bool
  help: Whether to include Codecov integration for coverage reporting.
  default: "{{ license != 'None' }}"
  when: "{{ license != 'None' }}"
coverage_threshold:
  type: int
  help: Minimum line coverage percentage to pass the quality gate (0 to disable).
  default: 80
robot_framework:
  type: bool
  help: Whether to include Robot Framework for integration testing.
  default: false
docs_style:
  type: str
  choices: ['diataxis', 'dita', 'user-journey', 'architecture', 'flat']
  help: The documentation style.
  default: 'dita'
release_please:
  type: bool
  help: Whether to include Release Please for automated releases and SemVer tagging.
  default: true
init_git_on_copy:
  type: bool
  help: Whether to initialize a Git repository right after scaffolding.
  default: true

_tasks:
  - command:
      - '{{ _copier_python }}'
      - -c
      - |
        import subprocess
        import sys

        check = subprocess.run(
            ["git", "rev-parse", "--is-inside-work-tree"],
            stdout=subprocess.DEVNULL,
            stderr=subprocess.DEVNULL,
        )
        if check.returncode == 0:
            raise SystemExit(0)

        # Try -b first (Git â‰¥ 2.28), fall back for older versions
        init = subprocess.run(
            ["git", "init", "-b", "main"],
            stderr=subprocess.DEVNULL,
        )
        if init.returncode != 0:
            init = subprocess.run(["git", "init"])
            if init.returncode == 0:
                subprocess.run(["git", "checkout", "-b", "main"])

        if init.returncode == 0:
            subprocess.run(["git", "config", "user.name", "{{ author_name }}"])
            subprocess.run(["git", "config", "user.email", "{{ author_email }}"])

        raise SystemExit(init.returncode)
    when: "{{ init_git_on_copy and _copier_operation == 'copy' }}"
